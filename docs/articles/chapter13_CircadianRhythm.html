<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>13. Circadian Rhythm Analysis • GGIR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="13. Circadian Rhythm Analysis">
<script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GGIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.2-8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-the-book" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">The book</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-the-book">
<li><a class="dropdown-item" href="../articles/chapter1_WhatIsGGIR.html">1. What is GGIR</a></li>
    <li><a class="dropdown-item" href="../articles/chapter2_Pipeline.html">2. The GGIR Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/chapter3_QualityAssessment.html">3. Data Quality Assurance</a></li>
    <li><a class="dropdown-item" href="../articles/chapter4_AccMetrics.html">4. From Raw Data to Acceleration Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/chapter5_StudyProtocol.html">5. Accounting for Study Protocol</a></li>
    <li><a class="dropdown-item" href="../articles/chapter6_DataImputation.html">6. How GGIR Deals with Invalid Data</a></li>
    <li><a class="dropdown-item" href="../articles/chapter7_DescribingDataWithoutKnowingSleep.html">7. Describing the Data Without Knowing Sleep</a></li>
    <li><a class="dropdown-item" href="../articles/chapter8_SleepFundamentalsSibs.html">8. Sleep Fundamentals - Sustained Inactivity Bout Detection (SIB)</a></li>
    <li><a class="dropdown-item" href="../articles/chapter9_SleepFundamentalsGuiders.html">9. Sleep Fundamentals - Guiding Sleep Detection</a></li>
    <li><a class="dropdown-item" href="../articles/chapter10_SleepAnalysis.html">10. Sleep Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/chapter11_DescribingDataCutPoints.html">11. Physical Activity Fundamentals - Describing the data with cut-points</a></li>
    <li><a class="dropdown-item" href="../articles/chapter12_TimeUseAnalysis.html">12. Time-Use Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/chapter13_CircadianRhythm.html">13. Circadian Rhythm Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/chapter14_BehaviouralFragmentation.html">14. Behavioural Fragmentation</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-annexes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Annexes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-annexes">
<li><a class="dropdown-item" href="../articles/GGIRParameters.html">GGIR Parameters</a></li>
    <li><a class="dropdown-item" href="../articles/GGIRoutput.html">GGIR Output</a></li>
    <li><a class="dropdown-item" href="../articles/readmyacccsv.html">Reading csv files with raw data</a></li>
    <li><a class="dropdown-item" href="../articles/ExternalFunction.html">Embedding external functions in GGIR</a></li>
    <li><a class="dropdown-item" href="../articles/CutPoints.html">Published cut-points and how to use them</a></li>
    <li><a class="dropdown-item" href="../articles/TutorialDaySegmentAnalyses.html">Day-segment analyses</a></li>
    <li><a class="dropdown-item" href="../articles/HouseHoldCoanalysis.html">Household co-analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Cookbook.html">Cookbook</a></li>
    <li><a class="dropdown-item" href="../articles/DateTimeFormatsInR.html">Date and Time formats in R</a></li>
    <li><a class="dropdown-item" href="../articles/SleepRegularityIndex.html">Sleep Regularity Index</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/chapter0_Installation.html">Installation</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/chapter0_GetStarted.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/ggir-release-3-2-0/">Version 3.2-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/ggir-release-3-1-5/">Version 3.1-5</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/ggir-release-3-1-0/">Version 3.1-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/ggir-release-3-0-0/">Version 3.0-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/ggir-release-2-9-0/">Version 2.9-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/ggir-release-2-8-0/">Version 2.8-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/ggir-release-2-7-1/">Version 2.7-1</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/ggir-release-2-6-0/">Version 2.6-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/ggir-release-2-5-0/">Version 2.5-0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/chapter0_Contributing.html">Contributing</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/chapter0_Support.html">Need help?</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/wadpac/GGIR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>13. Circadian Rhythm Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/wadpac/GGIR/blob/HEAD/vignettes/chapter13_CircadianRhythm.Rmd" class="external-link"><code>vignettes/chapter13_CircadianRhythm.Rmd</code></a></small>
      <div class="d-none name"><code>chapter13_CircadianRhythm.Rmd</code></div>
    </div>

    
    
<p>Circadian rhythm are the physical, mental, and behavioral changes an
organism experiences over a 24-hour cycle. GGIR facilitates a number of
techniques to quantify the movement-component of circadian rhythms as
discussed in this chapter.</p>
<p>Most of the techniques are applied in both GGIR part 2 and 6. The
main differences between these implementations are:</p>
<ul>
<li>In GGIR part 2 the circadian rhythm analysis tries to use every
valid data point in the recording.</li>
<li>In GGIR part 6 the circadian rhythm analysis uses a specific time
window as defined by the user, e.g. from first wake-up time till before
last wake-up time, and omits entire days that are considered invalid or
incomplete.</li>
</ul>
<p>As a result, when your intention is to compare physical activity or
sleep estimates derived in GGIR, part 6 estimates ensure that the same
days and time points are used as in the other parts of GGIR. Whereas,
part 2 does not attempt to do so.</p>
<p>Further, part 6 offers a few additional circadian rhythm estimates
such as DFA (discussed below), and when fragmentation analysis is turned
on (see parameter <code>frag.metrics</code> as discussed in the <a href="https://wadpac.github.io/GGIR/articles/chapter14_BehaviouralFragmentation.html">next
chapter</a>) activity and sleep fragmentation are also estimated.</p>
<div class="section level2">
<h2 id="mxlx">MXLX<a class="anchor" aria-label="anchor" href="#mxlx"></a>
</h2>
<p>MXLX looks for the continuous least (LX) and most (MX) active X hour
window in a day, where X is defined by parameter <code>winhr</code>. For
both LX and MX, GGIR calculates the average acceleration, the start
time, and if argument <code>iglevels</code> is specified also the
intensity gradient. If parameter <code>winhr</code> is a vector then MX
and LX are derived for each value in the vector.</p>
<p>Within GGIR part 2 MXLX is calculated per calendar day and, if
argument <code>qwindow</code> is specified, per segment of the day.
Within GGIR part 5 MXLX is calculated per <a href="https://wadpac.github.io/GGIR/articles/chapter12_TimeUseAnalysis.html#defining-the-time-windows">window</a>.
If used in combination with the GENEActiv or Axivity accelerometer
brands, LUX estimates per LX and MX are also included in GGIR part 5 csv
reports.</p>
<p>The MX metric described here should not be confused by the MX metrics
as proposed by <a href="https://doi.org/10.1186/s40798-019-0225-9" class="external-link">Rowlands et al.</a>
which looks at accumulated most active time which may not always be
continuous in time. The MX metrics by Rowlands et al. are discussed <a href="https://wadpac.github.io/GGIR/articles/chapter7_DescribingDataWithoutKnowingSleep.html#sets-of-quantiles-mx-metrics-by-rowlands-et-al-">here</a>.</p>
</div>
<div class="section level2">
<h2 id="extended-cosinor-analysis">(Extended) Cosinor analysis<a class="anchor" aria-label="anchor" href="#extended-cosinor-analysis"></a>
</h2>
<p>The Cosinor analysis quantifies the circadian 24 hour cycle. Cosinor
analysis refers to fitting a cosine function to a log transformed time
series, while the extended cosinor analysis refers to fitting a
non-linear transformation of the traditional cosinor curve to after
Marler et al. Statist. Med. 2006 (doi: 10.1002/sim.2466).</p>
<p>Corinos analyssis are not run by default, to tell GGIR to perform
these analyse specify parameter <code>cosinor = TRUE</code>. The
implementation is as follows:</p>
<ol style="list-style-type: decimal">
<li>The acceleration metric as specified with parameter
<code>acc.metric</code> is used.</li>
<li>Acceleration metric values are averaged per minute and expressed in
m<em>g</em> if the input is in <em>g</em>, and then log transformed as
<code>log(acceleration + 1)</code>.</li>
<li>Invalid data points such as caused by non-wear are set to missing
(<code>NA</code>) as we do not want the imputation used elsewhere in
GGIR to influence the Cosinor analysis. We do this because imputation
technique generally come with some assumptions about circadian
rhythm.</li>
<li>In part 2 GGIR uses all valid data in the recording while in part 6
we only use the valid data in the interval as defined with parameter
<code>part6Window</code>, e.g. first wake-up time till last wake-up
time.</li>
<li>GGIR looks for the first valid data point in the time series and
then selects the maximum integer number of recording days following this
data point.</li>
<li>If Day Saving Time occurs in the time series then duplicated
timestamps when clock moves backward are ignored and missing timestamps
when clock moves forward are inserted as missing values.</li>
<li>Cosinor models are fitted using functions <code>ActCosinor</code>
and <code>ActExtendCosinor</code> from R package <a href="https://CRAN.R-project.org/package=ActCR" class="external-link">ActCR</a>. Here,
<code>ActExtendCosinor</code> uses an anti-logistic function for the
transformation.</li>
<li>The time offset between the start of the time series as used and the
following midnight is used to reverse offset the ActCR results, to
ensure that acrophase and acrotime can be interpreted relative to
midnight.</li>
<li>Time series corresponding to the fitted models are stored inside the
part 2 milestone data as stored in output subfolder
<code>meta/ms2.out</code> to facilitate visual inspection. For the
moment they are not used in any GGIR visualisation, but you may want to
look them up and try to plot them yourself. They are stored in object
<code>SUM$cosinor_ts</code>.</li>
</ol>
</div>
<div class="section level2">
<h2 id="intradaily-variability-iv-and-interdaily-stability-is">Intradaily Variability (IV) and Interdaily Stability (IS)<a class="anchor" aria-label="anchor" href="#intradaily-variability-iv-and-interdaily-stability-is"></a>
</h2>
<p>IV and IS were first proposed by <a href="https://doi.org/10.1016/0006-3223(90)90523-5" class="external-link">Witting W et
al. 1990</a> and <a href="https://doi.org/10.1016/0006-3223(95)00370-3" class="external-link">van Someren EJ, et
al. 1996</a>.</p>
<ul>
<li><p>IS measures how constant is the routine of activity over several
days and ranges from 0 to 1, values close to 1 indicate more constant
routine.</p></li>
<li><p>IV measures the variability in activity hour by hour throughout
the days. It ranges from 0 to
+<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∞</mi><annotation encoding="application/x-tex">\infty</annotation></semantics></math>,
value close to 2 indicates more fragmented rhythm, and &gt;2 indicates
ultradian rhythm (very uncommon).</p></li>
</ul>
<p>The GGIR implementation of IV and IS since GGIR release 3.1-6 has
been described in <a href="https://doi.org/10.1186/s12874-024-02255-w" class="external-link">Danilevicz et
al. 2024</a>. This implementation replaces the experimental
implementation of IS and IV that was present in GGIR since release
1.5-1. In the experimental implementation we were not sure how to go
from raw acceleration signal to an indicator of being active as this
aspect was not documented in the original publications. Similarly, we
were not sure how to deal with missing data. However, these issues were
both resolved in release 3.1-6:</p>
<ul>
<li>Being active is now defined as a mean acceleration metric value
above the light physical activity threshold as specified with parameter
<code>threshold.lig</code>.</li>
<li>Missing values are left missing and not imputed, the algorithm now
accounts for this.</li>
</ul>
<p>The new implementation as documented by <a href="https://doi.org/10.1186/s12874-024-02255-w" class="external-link">Danilevicz et
al. 2024</a> is not compatible with the older experimental
implementation. Parameters <code>IVIS.activity.metric</code>,
<code>IVIS_windowsize_minutes</code>,
<code>IVIS_epochsize_seconds</code>, and <code>IVIS_acc_threshold</code>
that were used before is no longer needed and have been deprecated.</p>
<p><strong>Cosinor analysis compatible IV and IS</strong></p>
<p>IS is sometimes used as a measure of behavioural robustness when
conducting Cosinor analysis. However, to work with the combination of
the two outcomes it seems important that IS is calculated from the same
time series. Therefore, when <code>cosinor = TRUE,</code> IV and IS are
calculated twice: Once as part of the default IV and IS analysis as
discussed above, and once as part of the Cosinor analysis using the same
log transformed time series.</p>
<p>The Cosinor-compatible IV and IS estimates are stored as output
variables <code>cosinorIV</code> and <code>cosinorIS</code>.</p>
</div>
<div class="section level2">
<h2 id="phi">phi<a class="anchor" aria-label="anchor" href="#phi"></a>
</h2>
<p>Phi indicates how correlated the multi-day acceleration time series
is with itself when there is an hour shift, also known as first-order
auto-correlation from the first-order autoregressive model AR(1). A
higher phi value indicates a higher autocorrelation, while a phi close
to zero or even negative indicates more fragmented behavior. For a
detailed discussion of phi see <a href="https://doi.org/10.1080/01621459.1979.10482531" class="external-link">Dickey and Fuller
(1979)</a> and <a href="https://doi.org/10.1186/s12874-024-02255-w" class="external-link">Danilevicz et
al. 2024</a>. Phi is calculated by default in GGIR part 2 and in part 6
only when parameter <code>part6CR</code> is set to TRUE.</p>
</div>
<div class="section level2">
<h2 id="detrended-fluctionation-analysis-dfa">Detrended fluctionation analysis (DFA)<a class="anchor" aria-label="anchor" href="#detrended-fluctionation-analysis-dfa"></a>
</h2>
<div class="section level3">
<h3 id="self-similarity-paramerter-ssp">Self-similarity paramerter (SSP)<a class="anchor" aria-label="anchor" href="#self-similarity-paramerter-ssp"></a>
</h3>
<p>The self-similarity paramter (SSP) is also known as scaling exponent
or alpha. SSP is a real number between zero and two. Values in the range
(0, 1) indicate stationary motion behaviour. Values int he range (1, 2
indicate nonstationary motion behaviour. For details see <a href="https://doi.org/10.1093/bioinformatics/btaa955" class="external-link">Mesquita et al
2020</a> and <a href="https://doi.org/10.1186/s12874-024-02255-w" class="external-link">Danilevicz et
al. 2024</a>.</p>
</div>
<div class="section level3">
<h3 id="activity-balance-index-abi">Activity Balance Index (ABI)<a class="anchor" aria-label="anchor" href="#activity-balance-index-abi"></a>
</h3>
<p>The Activity Balance Index (ABI) was introduced by <a href="https://doi.org/10.1186/s12874-024-02255-w" class="external-link">Danilevicz et
al. 2024</a> and is a transformation of SSP. ABI measures how the
activity over the observed period is balanced, higher values reflect a
more balanced pattern of activity. ABI is a real number between zero and
one and calculated from the acceleration metric time series directly
without the need for cut-points.</p>
</div>
<div class="section level3">
<h3 id="sleep-regularity-index-sri">Sleep Regularity Index (SRI)<a class="anchor" aria-label="anchor" href="#sleep-regularity-index-sri"></a>
</h3>
<p>A discussion of the Sleep Regularity Index can be found in <a href="https://wadpac.github.io/GGIR/articles/SleepRegularityIndex.html" class="uri">https://wadpac.github.io/GGIR/articles/SleepRegularityIndex.html</a></p>
</div>
</div>
<div class="section level2">
<h2 id="related-output">Related output<a class="anchor" aria-label="anchor" href="#related-output"></a>
</h2>
<ul>
<li><p>MXLX are derived per 24 hours (part 2) and available per day in
part2_daysummary.csv, and summarised per recording in
part2_summary.csv.</p></li>
<li><p>MXLX are derived per window (part6) but only stored as recording
summary in part6_summary.csv.</p></li>
<li><p>All other circadian rhythm variables are only derived at
recording level. IV, IS, phi, and cosinor analysis variables and stored
in part2_summary.csv and part6_summary.csv, while SSP and ABI are only
stored in part6_summary.csv.</p></li>
<li><p>For a more detailed variable dictionary see annex on <a href="https://wadpac.github.io/GGIR/articles/GGIRoutput.html">GGIR
output</a>.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vincent T van Hees, Jairo H Migueles, Medical Research Council UK, Accelting, French National Research Agency.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
