# Function to identify invalid periods in the meta-data as generated by [g.getmeta](https://wadpac.github.io/GGIR/reference/g.getmeta.md) and to impute these invalid periods with the average of similar timepoints on other days of the measurement

Functions takes the output from
[g.getmeta](https://wadpac.github.io/GGIR/reference/g.getmeta.md) and
information about the study protocol to label impute invalid time
segments in the data.

## Usage

``` r
g.impute(M, I, params_cleaning = c(), desiredtz = "", dayborder = 0,
            TimeSegments2Zero = c(), acc.metric = "ENMO", ID, 
            qwindowImp = c(), ...)
```

## Arguments

- M:

  output from
  [g.getmeta](https://wadpac.github.io/GGIR/reference/g.getmeta.md)

- I:

  output from
  [g.inspectfile](https://wadpac.github.io/GGIR/reference/g.inspectfile.md)

- params_cleaning:

  See [g.part1](https://wadpac.github.io/GGIR/reference/g.part1.md)

- desiredtz:

  See [g.part1](https://wadpac.github.io/GGIR/reference/g.part1.md)

- dayborder:

  See [g.part1](https://wadpac.github.io/GGIR/reference/g.part1.md)

- TimeSegments2Zero:

  Optional data.frame to specify which time segments need to be ignored
  for the imputation, and acceleration metrics to be imputed by zeros.
  The data.frame is expected to contain two columns named windowstart
  and windowend, with the start- and end time of the time segment in
  POSIXlt class.

- acc.metric:

  See [GGIR](https://wadpac.github.io/GGIR/reference/GGIR.md)

- ID:

  ID extracted in g.part2.

- qwindowImp:

  qwindow object as documented in See
  [GGIR](https://wadpac.github.io/GGIR/reference/GGIR.md). If qwindow is
  based on a diary then the qwindow object is assumed to only include
  the values for the current participant ID.

- ...:

  Any argument used in the previous version of g.impute, which will now
  be used to overrule the arguments specified with the parameter
  objects.

## Value

- metashort:

  imputed short epoch variables

- rout:

  matrix to clarify when data was imputed for each long epoch time
  window and the reason for imputation. Value = 1 indicates imputation.
  Columns 1 = monitor non wear, column 2 = clipping, column 3 =
  additional nonwear, column 4 = protocol based exclusion and column5 =
  sum of column 1,2,3 and 4.

- averageday:

  matrix with n columns for n metrics values and m rows for m short
  epoch time windows in an average 24 hours period

## Author

Vincent T van Hees \<v.vanhees@accelting.com\>

## Examples

``` r
  if (FALSE) { # \dontrun{
    #inspect file:
    I = g.inspectfile(datafile)
    #autocalibration:
    C = g.calibrate(datafile) 
    #get meta-data:
    M = g.getmeta(datafile)
  } # }
  data(data.getmeta)
  data(data.inspectfile)
  #impute meta-data:
  IMP = g.impute(M=data.getmeta, I=data.inspectfile)
```
